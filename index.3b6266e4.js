!function(){function t(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}var n={};function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function r(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function a(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function o(t,e,i){a(t,e),e.set(t,i)}function l(t,e,i){var n=s(t,e,"set");return!function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,n,i),i}function h(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function u(t,e){a(t,e),e.add(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function f(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return c(t,void 0);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return c(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var d=new WeakMap,v=new WeakMap,m=new WeakMap,g=new WeakMap,y=new WeakSet,w=new WeakSet,p=new WeakSet,S=new WeakSet,k=new WeakSet,b=new WeakSet,M=new WeakSet,L=new WeakSet;function E(t){if("playing"===r(this,m)||"win"===r(this,m)){var e=!1;"left"===t||"right"===t?e=h(this,w,A).call(this,"left"===t):("up"===t||"down"===t)&&(h(this,M,j).call(this),e=h(this,w,A).call(this,"up"===t),h(this,M,j).call(this)),e&&(h(this,S,B).call(this),h(this,k,C).call(this))}}function A(t){var e=!1,i=!0,n=!1,s=void 0;try{for(var a,o=r(this,d)[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var l=a.value,u=t?l:f(l).reverse(),c=h(this,p,W).call(this,u),v=c.newRow;c.hasMoved&&(e=!0),l.splice.apply(l,[0,4].concat(f(t?v:v.reverse())))}}catch(t){n=!0,s=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw s}}return e}function W(t){for(var e=t.filter(function(t){return 0!==t}),i=[,,,,].fill(0),n=!1,s=0,a=0;a<e.length;a++)e[a]===e[a+1]?(i[s++]=2*e[a],l(this,v,r(this,v)+2*e[a]),2048===i[s-1]&&l(this,m,"win"),a++,n=!0):(i[s++]=e[a],i[s-1]!==t[s-1]&&(n=!0));return{newRow:i,hasMoved:n}}function B(){var t=[];if(r(this,d).forEach(function(e,i){return e.forEach(function(e,n){0===e&&t.push({i:i,j:n})})}),t.length>0){var e=t[Math.floor(Math.random()*t.length)],i=e.i,n=e.j;r(this,d)[i][n]=.9>Math.random()?2:4}}function C(){"win"===r(this,m)||h(this,b,q).call(this)||l(this,m,"lose")}function q(){var t=this;return r(this,d).some(function(e,i){return e.some(function(n,s){return 0===n||s<3&&n===e[s+1]||i<3&&n===r(t,d)[i+1][s]})})}function j(){var t=this;l(this,d,r(this,d)[0].map(function(e,i){return r(t,d).map(function(t){return t[i]})}))}function G(t){return t.map(function(t){return f(t)})}n=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t(this,e),u(this,y),u(this,w),u(this,p),u(this,S),u(this,k),u(this,b),u(this,M),u(this,L),o(this,d,{writable:!0,value:void 0}),o(this,v,{writable:!0,value:void 0}),o(this,m,{writable:!0,value:void 0}),o(this,g,{writable:!0,value:void 0}),l(this,g,i?h(this,L,G).call(this,i):Array.from({length:4},function(){return[,,,,].fill(0)})),this.restart()}return i(e,[{key:"getState",value:function(){return h(this,L,G).call(this,r(this,d))}},{key:"getScore",value:function(){return r(this,v)}},{key:"getStatus",value:function(){return r(this,m)}},{key:"start",value:function(){"idle"===r(this,m)&&(h(this,S,B).call(this),h(this,S,B).call(this),l(this,m,"playing"))}},{key:"restart",value:function(){l(this,d,h(this,L,G).call(this,r(this,g))),l(this,v,0),l(this,m,"idle")}},{key:"moveLeft",value:function(){h(this,y,E).call(this,"left")}},{key:"moveRight",value:function(){h(this,y,E).call(this,"right")}},{key:"moveUp",value:function(){h(this,y,E).call(this,"up")}},{key:"moveDown",value:function(){h(this,y,E).call(this,"down")}}]),e}(),new(function(){function e(i){t(this,e);var n=function(){this.fieldCells.forEach(function(t){t.classList.add("bounce")}),this.fieldCells.forEach(function(t){t.addEventListener("animationend",function(){t.classList.remove("bounce")},{once:!0})})};this.game=i,this.scoreElement=document.querySelector(".game-score"),this.gameField=document.querySelector(".game-field"),this.fieldCells=document.querySelectorAll(".field-cell"),this.startButton=document.querySelector(".button.start"),this.restartButton=document.querySelector(".button.restart"),this.loseMessage=document.querySelector(".message-lose"),this.winMessage=document.querySelector(".message-win"),this.startMessage=document.querySelector(".message-start"),this.startButton.addEventListener("click",this.startGame.bind(this)),this.startButton.addEventListener("click",n.bind(this)),this.restartButton.addEventListener("click",this.restartGame.bind(this)),document.addEventListener("keydown",this.handleKeyDown.bind(this)),this.restartButton.addEventListener("click",n.bind(this)),this.renderField(),this.updateScore(),this.showStartMessage()}return i(e,[{key:"renderField",value:function(){var t=this.game.getState();this.fieldCells.forEach(function(e,i){var n=t[Math.floor(i/4)][i%4];e.className="field-cell",0!==n?(e.classList.add("field-cell--".concat(n)),e.textContent=n):e.textContent=""})}},{key:"updateScore",value:function(){this.scoreElement.textContent=this.game.getScore()}},{key:"resetMessages",value:function(){this.loseMessage.classList.add("hidden"),this.winMessage.classList.add("hidden"),this.startMessage.classList.add("hidden")}},{key:"showStartMessage",value:function(){this.startMessage.classList.remove("hidden")}},{key:"startGame",value:function(){this.game.start(),this.renderField(),this.updateScore(),this.resetMessages(),this.restartButton.classList.remove("hidden"),this.startButton.classList.add("hidden")}},{key:"restartGame",value:function(){this.game.restart(),this.startGame()}},{key:"handleKeyDown",value:function(t){if("playing"===this.game.getStatus()||"win"===this.game.getStatus()){var e={ArrowLeft:"moveLeft",ArrowRight:"moveRight",ArrowUp:"moveUp",ArrowDown:"moveDown"}[t.key];e&&(this.game[e](),this.renderField(),this.updateScore(),this.checkGameStatus())}}},{key:"checkGameStatus",value:function(){"win"===this.game.getStatus()?this.winMessage.classList.remove("hidden"):"lose"===this.game.getStatus()&&(this.loseMessage.classList.remove("hidden"),this.restartButton.classList.remove("hidden"),this.startButton.classList.add("hidden"))}}]),e}())(new n)}();
//# sourceMappingURL=index.3b6266e4.js.map
